START:
OPEN "DRAWQB.BAS" FOR APPEND AS #1
CLOSE
KILL "DRAWQB.BAS"
CLOSE
COLSC = 15
INI:
ON ERROR GOTO ERRORSR
SCR = 13
0.0 SCREEN SCR
VIEW PRINT 21 TO 25
LINE (0, 0)-(319, 156), 103, B
VIEW (1, 1)-(318, 155)
ON KEY(1) GOSUB CREDIT: KEY(1) ON
X = 159: Y = 78: NUM = 1
PSET (X, Y), 39
OPEN "DRAWD.BAS" FOR APPEND AS #1
CLOSE
KILL "DRAWD.BAS"
OPEN "NONAME.DRW" FOR APPEND AS #1
CLOSE
KILL "NONAME.DRW"
ON ERROR GOTO ERRO
OPEN "C:\QB\DRAW.DAT" FOR INPUT AS #1
FOR B = 1 TO 9
INPUT #1, B$
KEY B + 1, B$
NEXT B
CLOSE
CLS 2
1 PRINT "x="; X; "  "; "y="; Y
GOSUB BDC
GOSUB PEC
CLOSE
0 INPUT LINEACOM$
COMANDO$ = LEFT$(LINEACOM$, 4)
IF COMANDO$ = "LEFT" THEN GOTO LEFT
IF COMANDO$ = "RGTH" THEN GOTO RGTH
IF COMANDO$ = "ABOV" THEN GOTO ABOV
IF COMANDO$ = "DOWN" THEN GOTO DOWN
IF COMANDO$ = "CIRC" THEN GOTO CIRC
IF COMANDO$ = "MOVE" THEN GOTO MOVE
IF COMANDO$ = "MOVR" THEN GOTO MOVR
IF COMANDO$ = "MOVL" THEN GOTO MOVL
IF COMANDO$ = "MOVA" THEN GOTO MOVA
IF COMANDO$ = "MOVD" THEN GOTO MOVD
IF COMANDO$ = "LINE" THEN GOTO LINEA
IF COMANDO$ = "CLSC" THEN GOTO CLSC
IF COMANDO$ = "HOME" THEN GOTO HOME
IF COMANDO$ = "EXIT" THEN GOTO EXITODOS
IF COMANDO$ = "COLR" THEN GOTO COLR
IF COMANDO$ = "LOAD" THEN GOTO LOAD
IF COMANDO$ = "SAVE" THEN GOSUB SAV
IF COMANDO$ = "HELP" THEN GOTO HELP
IF COMANDO$ = "NEWD" THEN GOTO NEWD
IF COMANDO$ = "PANT" THEN GOTO PANT
IF COMANDO$ = "CONF" THEN GOTO CONF
IF COMANDO$ = "LSCL" THEN GOTO LSCL
IF COMANDO$ = "DRAW" THEN GOTO DAW
GOTO 1
LSCL:
GOSUB SAV
CLS 1
COLSC = 0
LISTA:
LINE (COLSC, 1)-(COLSC, 155), COLSC
PRINT COLSC
COLSC = COLSC + 1
IF COLSC > 255 THEN CLS 1: GOTO OO
A$ = INPUT$(1)
IF A$ = CHR$(27) THEN CLS 1: GOTO OO
GOTO LISTA
OO:
OPEN "NONAME.DRW" FOR APPEND AS #NUM
PRINT #NUM, "COLR"
PRINT #NUM, COLSC
CLOSE
PUNTO = 0
GOTO INI

LEFT:
2 INPUT " * ", COR
IF X - COR < 1 THEN GOTO 2
GOSUB BDC
LINE (X, Y)-(X - COR, Y), COLSC
X = X - COR
OPEN "DRAWD.BAS" FOR APPEND AS #1
PRINT #1, "LINE("; X; ","; Y; ")-("; X + COR; ","; Y; ")"
CLOSE
GOSUB PEC
NUM = NUM + 1
OPEN "NONAME.DRW" FOR APPEND AS #NUM
PRINT #NUM, COMANDO$
PRINT #NUM, COR
GOTO 1

RGTH:
3 INPUT " * ", COR
IF X + COR > 318 THEN GOTO 3
GOSUB BDC
LINE (X, Y)-(X + COR, Y), COLSC
X = X + COR
OPEN "DRAWD.BAS" FOR APPEND AS #1
PRINT #1, "LINE("; X; ","; Y; ")-("; X - COR; ","; Y; ")"
CLOSE
GOSUB PEC
OPEN "NONAME.DRW" FOR APPEND AS #NUM
PRINT #NUM, COMANDO$
PRINT #NUM, COR
GOTO 1

ABOV:
4 INPUT " * ", COR
IF Y - COR < 1 THEN GOTO 4
GOSUB BDC
LINE (X, Y)-(X, Y - COR), COLSC
Y = Y - COR
OPEN "DRAWD.BAS" FOR APPEND AS #1
PRINT #1, "LINE("; X; ","; Y; ")-("; X; ","; Y + COR; ")"
CLOSE
GOSUB PEC
NUM = NUM + 1
OPEN "NONAME.DRW" FOR APPEND AS #NUM
PRINT #NUM, COMANDO$
PRINT #NUM, COR
GOTO 1

DOWN:
5 INPUT " * ", COR
IF Y + COR > 155 THEN GOTO 5
GOSUB BDC
LINE (X, Y)-(X, Y + COR), COLSC
Y = Y + COR
GOSUB PEC
NUM = NUM + 1
OPEN "NONAME.DRW" FOR APPEND AS #NUM
PRINT #NUM, COMANDO$
PRINT #NUM, COR
GOTO 1

CIRC:
INPUT " * ", COR
CIRCLE (X, Y), COR, COLSC
NUM = NUM + 1
OPEN "NONAME.DRW" FOR APPEND AS #NUM
PRINT #NUM, COMANDO$
PRINT #NUM, COR
GOTO 1

MOVR:
6 INPUT " * ", COR
IF COR + X > 318 THEN GOTO 6
GOSUB BDC
X = X + COR
GOSUB PEC
NUM = NUM + 1
OPEN "NONAME.DRW" FOR APPEND AS #NUM
PRINT #NUM, COMANDO$
PRINT #NUM, COR
GOTO 1

MOVL:
7 INPUT " * ", COR
IF COR - X > 1 THEN GOTO 7
GOSUB BDC
X = X - COR
GOSUB PEC
NUM = NUM + 1
OPEN "NONAME.DRW" FOR APPEND AS #NUM
PRINT #NUM, COMANDO$
PRINT #NUM, COR
GOTO 1

MOVA:
8 INPUT " * ", COR
IF COR - Y > 1 THEN GOTO 8
GOSUB BDC
Y = Y - COR
GOSUB PEC
NUM = NUM + 1
OPEN "NONAME.DRW" FOR APPEND AS #NUM
PRINT #NUM, COMANDO$
PRINT #NUM, COR
GOTO 1

MOVD:
9 INPUT " * ", COR
IF COR + Y > 155 THEN GOTO 9
GOSUB BDC
Y = Y + COR
GOSUB PEC
NUM = NUM + 1
OPEN "NONAME.DRW" FOR APPEND AS #NUM
PRINT #NUM, COMANDO$
PRINT #NUM, COR
GOTO 1

LINEA:
10 INPUT " *x ", CORX
IF CORX > 318 THEN GOTO 10
IF CORX < 1 THEN GOTO 10
11 INPUT " *y ", CORY
IF CORY > 155 THEN GOTO 11
IF CORY < 1 THEN GOTO 11
GOSUB BDC
LINE (X, Y)-(CORX, CORY), COLSC
X = CORX: Y = CORY
GOSUB PEC
OPEN "NONAME.DRW" FOR APPEND AS #NUM
PRINT #NUM, COMANDO$
PRINT #NUM, X
PRINT #NUM, Y
GOTO 1

CLSC:
CLS 1
GOSUB PEC
NUM = NUM + 1
OPEN "NONAME.DRW" FOR APPEND AS #NUM
PRINT #NUM, COMANDO$
GOSUB BDC
GOSUB PEC
GOTO 1

HOME:
GOSUB BDC
X = 159: Y = 78
GOSUB PEC
NUM = NUM + 1
OPEN "NONAME.DRW" FOR APPEND AS #NUM
PRINT #NUM, COMANDO$
GOTO 1

COLR:
12 INPUT " * ", COLSC
NUM = NUM + 1
OPEN "NONAME.DRW" FOR APPEND AS #NUM
PRINT #NUM, COMANDO$
PRINT #NUM, COLSC
GOTO 1

MOVE:
13 INPUT " *x ", CORX
IF CORX > 318 THEN GOTO 13
IF CORX < 1 THEN GOTO 13
14 INPUT " *y ", CORY
IF CORY > 155 THEN GOTO 14
IF CORY < 1 THEN GOTO 14
GOSUB BDC
X = CORX: Y = CORY
GOSUB PEC
NUM = NUM + 1
OPEN "NONAME.DRW" FOR APPEND AS #NUM
PRINT #NUM, COMANDO$
PRINT #NUM, X
PRINT #NUM, Y
GOTO 1

PEC:
PUNTO = POINT(X, Y)
PSET (X, Y), 39
RETURN
BDC:
PSET (X, Y), PUNTO
RETURN
EXITODOS:
P:
INPUT "Save changes (Y/N)", S$
IF S$ = "N" OR S$ = "n" THEN
OPEN "NONAME.DRW" FOR APPEND AS #1: CLOSE
KILL "NONAME.DRW": END
END IF
IF S$ = "Y" OR S$ = "y" THEN GOSUB SAV ELSE GOTO P
SAV:
INPUT "Save name: "; N$
IF N$ = "" THEN RETURN
ON ERROR GOTO ERROR2
NAME "NONAME.DRW" AS N$
RETURN

LOAD:
INPUT "Name: ", NAME$
ON ERROR GOTO ERROR1
OPEN NAME$ FOR INPUT AS #1
CLS 1
X = 159: Y = 78
LD:
GOSUB BDC
GOSUB PEC
ON ERROR GOTO ERRO
INPUT #1, COMANDO$
IF COMANDO$ = "LEFT" THEN GOTO LEFTL
IF COMANDO$ = "RGTH" THEN GOTO RGTHL
IF COMANDO$ = "ABOV" THEN GOTO ABOVL
IF COMANDO$ = "DOWN" THEN GOTO DOWNL
IF COMANDO$ = "CIRC" THEN GOTO CIRCL
IF COMANDO$ = "MOVE" THEN GOTO MOVEL
IF COMANDO$ = "MOVR" THEN GOTO MOVRL
IF COMANDO$ = "MOVL" THEN GOTO MOVLL
IF COMANDO$ = "MOVA" THEN GOTO MOVAL
IF COMANDO$ = "MOVD" THEN GOTO MOVDL
IF COMANDO$ = "LINE" THEN GOTO LINEAL
IF COMANDO$ = "CLSC" THEN GOTO CLSCL
IF COMANDO$ = "HOME" THEN GOTO HOMEL
IF COMANDO$ = "COLR" THEN GOTO COLRL
IF COMANDO$ = "PANT" THEN GOTO PANTL

GOTO LD
LEFTL:
INPUT #1, COR
GOSUB BDC
LINE (X, Y)-(X - COR, Y), COLSC
X = X - COR
GOSUB PEC
GOTO LD

RGTHL:
INPUT #1, COR
GOSUB BDC
LINE (X, Y)-(X + COR, Y), COLSC
X = X + COR
GOSUB PEC
GOTO LD

ABOVL:
INPUT #1, COR
IF Y - COR < 1 THEN GOTO LD
GOSUB BDC
LINE (X, Y)-(X, Y - COR), COLSC
Y = Y - COR
GOSUB PEC
GOTO LD

DOWNL:
INPUT #1, COR
IF Y + COR > 155 THEN GOTO LD
GOSUB BDC
LINE (X, Y)-(X, Y + COR), COLSC
Y = Y + COR
GOSUB PEC
GOTO LD

CIRCL:
INPUT #1, COR
CIRCLE (X, Y), COR, COLSC
GOTO LD

MOVRL:
INPUT #1, COR
IF COR + X > 318 THEN GOTO LD
GOSUB BDC
X = X + COR
GOSUB PEC
GOTO LD

MOVLL:
INPUT #1, COR
IF COR - X > 1 THEN GOTO LD
GOSUB BDC
X = X - COR
GOSUB PEC
GOTO LD

MOVAL:
INPUT #1, COR
IF COR - Y > 1 THEN GOTO LD
GOSUB BDC
Y = Y - COR
GOSUB PEC
GOTO LD

MOVDL:
INPUT #1, COR
IF COR + Y > 155 THEN GOTO LD
GOSUB BDC
Y = Y + COR
GOSUB PEC
GOTO LD

LINEAL:
INPUT #1, CORX
INPUT #1, CORY
IF CORX > 318 THEN GOTO LD
IF CORX < 1 THEN GOTO LD
IF CORY > 155 THEN GOTO LD
IF CORY < 1 THEN GOTO LD
GOSUB BDC
LINE (X, Y)-(CORX, CORY), COLSC
X = CORX: Y = CORY
GOSUB PEC
GOTO LD

CLSCL:
CLS 1
GOSUB PEC
GOTO LD

HOMEL:
GOSUB BDC
X = 159: Y = 78
GOSUB PEC
GOTO LD

COLRL:
INPUT #1, COLSC
GOTO LD

MOVEL:
INPUT #1, CORX
IF CORX > 318 THEN GOTO LD
IF CORX < 1 THEN GOTO LD
INPUT #1, CORY
IF CORY > 155 THEN GOTO LD
IF CORY < 1 THEN GOTO LD
GOSUB BDC
X = CORX: Y = CORY
GOSUB PEC
GOTO LD

ERRO:
GOSUB BDC
GOSUB PEC
RESUME 1

ERROR1:
IF ERR = 76 THEN
PRINT "Path not found."
END IF
IF ERR = 53 THEN
PRINT "File not found."
ELSE
PRINT "Error !!!"
END IF
RESUME 1

ERROR2:
IF ERR = 53 THEN
END IF
IF ERR = 74 THEN
PRINT ""
END IF
IF ERR = 61 THEN
PRINT "Disk full !!!"
ELSE
PRINT "Error !!!"
END IF
RESUME 1
HELP:
GOSUB SAV
WIDTH 80, 25
SCREEN 0
COLOR 6, 9: CLS
PRINT "   --------------------  AYUDA ESPA¥OL DE DRAW v 1.0 --------------------- "
COLOR 2
PRINT
PRINT
PRINT " Comandos de DRAW:"
PRINT
COLOR 11
PRINT "ABOV: (ARRIBA)"
PRINT "     Utilice este comando para hacer una linea vertical recta hacia arriba."
PRINT
PRINT "CIRC: (CIRCULO)"
PRINT "     Dibuja circulos en la pantalla."
PRINT
PRINT "CLSC: (Borrar Pantalla)"
PRINT "     Borra la pantalla gr fica dejando el cursor en la misma posici¢n."
PRINT
PRINT "COLR: (COLOR)"
PRINT "     Cambia el color de las lineas."
PRINT
PRINT "DOWN: (ABAJO)"
PRINT "     Dibuja una linea vertical hacia abajo."
PRINT
GOSUB BORRAR
LOCATE 4, 1
PRINT "EXIT: (SALIR)"
PRINT "     Avandona DRAW."
PRINT
PRINT "HOME: (HOGAR)"
PRINT "     Coloca el cursor en la posici¢n inicial."
PRINT
PRINT "LEFT: (IZQUIERDA)"
PRINT "     Dibuja una linea horizontal hacia la izquierda"
PRINT
PRINT "LINE: (LINEA)"
PRINT "      Dibuja una linea desde la posici¢n actual del cursor a un punto."
PRINT
PRINT "LSCL: (LISTA DE COLORES)"
PRINT "       Muestra la lista de colores en la pantalla."
PRINT
PRINT "MOVA: (MOVER ARRIBA)"
PRINT "     Mueve el cursor hacia arriba."
GOSUB BORRAR
LOCATE 4, 1
PRINT "MOVD: (MOVER ABAJO)"
PRINT "     Mueve el cursor hacia abajo."
PRINT
PRINT "MOVE: (MOVER)"
PRINT "     Coloca el cursor en la cordenada deseada."
PRINT
PRINT "MOVL: (MOVER IZQUIERDA)"
PRINT "     Mueve el cursor a la izquierda."
PRINT
PRINT "MOVR: (MOVER DERECHA)"
PRINT "     Mueve el cursor a la derecha."
PRINT
PRINT "NEWD: (NUEVO GRAFICA)"
PRINT "     Utilice este comando para crear un dibujo nuevo."
PRINT
PRINT "PANT: (COLOREAR)"
PRINT "     Permite colorear un area cerrada del dibujo."
GOSUB BORRAR
GOTO INI
BORRAR:
PRINT
PRINT
PRINT "  (Presione una tecla y contin£e)"
A$ = INPUT$(1)
IF A$ = CHR$(27) THEN GOTO INI
FOR A = 1 TO 80
A$ = INKEY$
FOR B = 2 TO 23
A$ = INKEY$
LOCATE B, A: PRINT " "
NEXT B
A$ = INKEY$
NEXT A
RETURN
NEWD:
GOSUB SAV
X = 159: Y = 78
CLS 1
OPEN "NONAME.DRW" FOR APPEND AS #1
CLOSE
KILL "NONAME.DRW"
GOSUB BDC
GOSUB PEC
GOTO 1
PANT:
INPUT " * "; COCO
GOSUB BDC
PAINT (X, Y), COLSC, COCO
GOSUB PEC
OPEN "NONAME.DRW" FOR APPEND AS #NUM
PRINT #NUM, COMANDO$
PRINT #NUM, COCO
CLOSE
GOTO 1
CREDIT:
COLOR 11
PRINT "Author: Jairo Alejandro Duarte A."
COLOR 3
PRINT "Collaboration: Juan Carlos Duarte A."
COLOR 6
PRINT "DA Software."
COLOR 7
RETURN
ERRORSR:
IF ERR = 5 THEN
SCR = SCR - 1
END IF
RESUME 0.0
PANTL:
INPUT #1, COCO
GOSUB BDC
PAINT (X, Y), COLSC, COCO
GOSUB PEC
GOTO LD
CONF:
CLOSE
OPEN "C:\QB\DRAW.DAT" FOR APPEND AS #1
CLOSE
KILL "C:\QB\DRAW.DAT"

FOR A = 2 TO 10
OPEN "C:\QB\DRAW.DAT" FOR APPEND AS #1
PRINT "F"; A; ": ";
INPUT A$
KEY A, A$
PRINT #1, A$
CLOSE
NEXT A
GOTO 1
DAW:
A:
PRINT "X="; X; "Y="; Y
A$ = INPUT$(1)
IF A$ = "8" OR A$ = "W" THEN GOTO ARRIBA
IF A$ = "2" OR A$ = "S" THEN GOTO ABAJO
IF A$ = "4" OR A$ = "A" THEN GOTO IZ
IF A$ = "6" OR A$ = "D" THEN GOTO DE
IF A$ = "7" OR A$ = "Q" THEN GOTO IA
IF A$ = "9" OR A$ = "E" THEN GOTO DA
IF A$ = "1" OR A$ = "Z" THEN GOTO IB
IF A$ = "3" OR A$ = "C" THEN GOTO DB
IF A$ = "5" OR A$ = "G" THEN GOTO GRA
IF A$ = CHR$(13) THEN GOTO PA
IF A$ = " " THEN GOTO PINTAR
IF A$ = "F" OR A$ = "f" THEN GOTO COLORES
IF A$ = "P" OR A$ = "p" THEN GOTO PAN
GOTO A
ARRIBA:
GOSUB BDC
Y = Y - 1
IF Y < 1 THEN Y = 1
GOSUB PEC
GOTO A

ABAJO:
GOSUB BDC
Y = Y + 1
IF Y > 154 THEN Y = 154
GOSUB PEC
GOTO A

IZ:
GOSUB BDC
X = X - 1
IF X < 1 THEN X = 1
GOSUB PEC
GOTO A

DE:
GOSUB BDC
X = X + 1
IF X > 317 THEN X = 317
GOSUB PEC
GOTO A

PINTAR:
PSET (X, Y), COLSC
X = X + 1
GOSUB PEC
GOTO A
COLORES:
INPUT "Color"; COLSC
GOTO A
IA:
GOSUB BDC
X = X - 1: Y = Y - 1
IF Y < 1 THEN Y = 1
IF X < 1 THEN X = 1
GOSUB PEC
GOTO A

DA:
GOSUB BDC
X = X + 1: Y = Y - 1
IF Y < 1 THEN Y = 1
IF X > 317 THEN X = 317
GOSUB PEC
GOTO A

IB:
GOSUB BDC
X = X - 1: Y = Y + 1
IF Y > 154 THEN Y = 154
IF X < 1 THEN X = 1
GOSUB PEC
GOTO A

DB:
GOSUB BDC
X = X + 1: Y = Y + 1
IF Y > 154 THEN Y = 154
IF X > 317 THEN X = 317
GOSUB PEC
GOTO A

PA:
GOSUB BDC
PSET (X, Y), 0
GOSUB PEC
GOTO A

PAN:
INPUT "*", CONTORNO
IF CONTORNO = 0 THEN
PAINT (X, Y), COLSC
GOSUB BDC
ELSE
PAINT (X, Y), COLSC, CONTORNO
GOSUB BDC
GOSUB PEC
END IF
GOTO A
GRA:
GOSUB BDC
FOR X = 1 TO 317
FOR Y = 1 TO 154
GOSUB PEC
GOSUB BDC
C = POINT(X, Y)
PRINT "Please wait..."
IF C <> 0 THEN GOSUB GRABA
NEXT Y
NEXT X
END
GRABA:
OPEN "DRAWQB.BAS" FOR APPEND AS #1
PRINT #1, "PSET("; X; ","; Y; "),"; C
CLOSE
RETURN

