START:
CLOSE
COLSC = 15
INI:
ON ERROR GOTO ERRORSR
SCR = 13
1000 SCREEN SCR
VIEW PRINT 21 TO 25
LINE (0, 0)-(319, 156), 103, B
VIEW (1, 1)-(318, 155)
ON KEY(1) GOSUB CREDIT: KEY(1) ON
X = 159: Y = 78: NUM = 1
PSET (X, Y), 39
ON ERROR GOTO ERRO
OPEN "C:DRAW.DAT" FOR INPUT AS #1
FOR B = 1 TO 9
INPUT #1, B$
KEY B + 1, B$
NEXT B
CLOSE
CLS 2
1 PRINT "x="; X; "  "; "y="; Y
GOSUB BDC
GOSUB PEC
CLOSE
0 INPUT LINEACOM$
COMANDO$ = LEFT$(LINEACOM$, 4)
IF COMANDO$ = "LEFT" THEN GOTO LEFT
IF COMANDO$ = "RGTH" THEN GOTO RGTH
IF COMANDO$ = "ABOV" THEN GOTO ABOV
IF COMANDO$ = "DOWN" THEN GOTO DOWN
IF COMANDO$ = "CIRC" THEN GOTO CIRC
IF COMANDO$ = "MOVE" THEN GOTO MOVE
IF COMANDO$ = "MOVR" THEN GOTO MOVR
IF COMANDO$ = "MOVL" THEN GOTO MOVL
IF COMANDO$ = "MOVA" THEN GOTO MOVA
IF COMANDO$ = "MOVD" THEN GOTO MOVD
IF COMANDO$ = "LINE" THEN GOTO LINEA
IF COMANDO$ = "CLSC" THEN GOTO CLSC
IF COMANDO$ = "HOME" THEN GOTO HOME
IF COMANDO$ = "EXIT" THEN GOTO EXITODOS
IF COMANDO$ = "COLR" THEN GOTO COLR
IF COMANDO$ = "SAVE" THEN GOSUB 15
IF COMANDO$ = "HELP" THEN GOTO HELP
IF COMANDO$ = "NEWD" THEN GOTO NEWD
IF COMANDO$ = "PANT" THEN GOTO PANT
IF COMANDO$ = "CONF" THEN GOTO CONF
IF COMANDO$ = "LSCL" THEN GOTO LSCL
IF COMANDO$ = "LOAD" THEN GOTO LOAD
IF COMANDO$ = "DRAW" THEN GOTO DAW
GOTO 1
LSCL:
CLS 1
COLSC = 0
LISTA:
LINE (COLSC, 1)-(COLSC, 155), COLSC
PRINT COLSC
COLSC = COLSC + 1
IF COLSC > 255 THEN CLS 1: GOTO OO
A$ = INPUT$(1)
IF A$ = CHR$(27) THEN CLS 1: GOTO OO
GOTO LISTA
OO:
PUNTO = 0
GOTO INI

LEFT:
2 INPUT " * ", COR
IF X - COR < 1 THEN GOTO 2
GOSUB BDC
LINE (X, Y)-(X - COR, Y), COLSC
X = X - COR
GOSUB PEC
NUM = NUM + 1
GOTO 1

RGTH:
3 INPUT " * ", COR
IF X + COR > 318 THEN GOTO 3
GOSUB BDC
LINE (X, Y)-(X + COR, Y), COLSC
X = X + COR
GOSUB PEC
GOTO 1

ABOV:
4 INPUT " * ", COR
IF Y - COR < 1 THEN GOTO 4
GOSUB BDC
LINE (X, Y)-(X, Y - COR), COLSC
Y = Y - COR
GOSUB PEC
NUM = NUM + 1
GOTO 1

DOWN:
5 INPUT " * ", COR
IF Y + COR > 155 THEN GOTO 5
GOSUB BDC
LINE (X, Y)-(X, Y + COR), COLSC
Y = Y + COR
GOSUB PEC
NUM = NUM + 1
GOTO 1

CIRC:
INPUT " * ", COR
CIRCLE (X, Y), COR, COLSC
NUM = NUM + 1
GOTO 1

MOVR:
6 INPUT " * ", COR
IF COR + X > 318 THEN GOTO 6
GOSUB BDC
X = X + COR
GOSUB PEC
NUM = NUM + 1
GOTO 1

MOVL:
7 INPUT " * ", COR
IF COR - X > 1 THEN GOTO 7
GOSUB BDC
X = X - COR
GOSUB PEC
NUM = NUM + 1
GOTO 1

MOVA:
8 INPUT " * ", COR
IF COR - Y > 1 THEN GOTO 8
GOSUB BDC
Y = Y - COR
GOSUB PEC
NUM = NUM + 1
GOTO 1

MOVD:
9 INPUT " * ", COR
IF COR + Y > 155 THEN GOTO 9
GOSUB BDC
Y = Y + COR
GOSUB PEC
NUM = NUM + 1
GOTO 1

LINEA:
10 INPUT " *x ", CORX
IF CORX > 318 THEN GOTO 10
IF CORX < 1 THEN GOTO 10
11 INPUT " *y ", CORY
IF CORY > 155 THEN GOTO 11
IF CORY < 1 THEN GOTO 11
GOSUB BDC
LINE (X, Y)-(CORX, CORY), COLSC
X = CORX: Y = CORY
GOSUB PEC
GOTO 1

CLSC:
CLS 1
GOSUB PEC
NUM = NUM + 1
GOSUB BDC
GOSUB PEC
GOTO 1

HOME:
GOSUB BDC
X = 159: Y = 78
GOSUB PEC
NUM = NUM + 1
GOTO 1

COLR:
12 INPUT " * ", COLSC
NUM = NUM + 1
GOTO 1

MOVE:
13 INPUT " *x ", CORX
IF CORX > 318 THEN GOTO 13
IF CORX < 1 THEN GOTO 13
14 INPUT " *y ", CORY
IF CORY > 155 THEN GOTO 14
IF CORY < 1 THEN GOTO 14
GOSUB BDC
X = CORX: Y = CORY
GOSUB PEC
NUM = NUM + 1
GOTO 1
PEC:
PUNTO = POINT(X, Y)
PSET (X, Y), 39
RETURN
BDC:
PSET (X, Y), PUNTO
RETURN
EXITODOS:
P:
INPUT "Save changes (Y/N)", S$
IF S$ = "N" OR S$ = "n" THEN END
IF S$ = "Y" OR S$ = "y" THEN
15 INPUT "QBASIC name:", BNAME$
X1 = X: Y1 = Y
IF BNAME$ = "*" THEN GOTO 1
OPEN BNAME$ FOR APPEND AS #1
CLOSE
KILL BNAME$
INPUT "Draw name:", DNAME$
IF DNAME$ = "*" THEN GOTO 1
CLOSE
OPEN DNAME$ FOR APPEND AS #1
CLOSE
KILL DNAME$
CLOSE
GOSUB BDC
FOR X = X1 TO 317
FOR Y = Y1 TO 154
A$ = INKEY$
IF A$ = CHR$(27) THEN GOSUB PEC: GOTO A
GOSUB PEC
GOSUB BDC
C = POINT(X, Y)
PRINT "Please wait..."
IF C <> 0 THEN GOSUB GRABA
NEXT Y
NEXT X
GOTO 1
END IF


ERRO:
GOSUB BDC
GOSUB PEC
RESUME 1

ERROR1:
IF ERR = 76 THEN
PRINT "Path not found."
END IF
IF ERR = 53 THEN
PRINT "File not found."
ELSE
PRINT "Error !!!"
END IF
RESUME 1

ERROR2:
IF ERR = 53 THEN
END IF
IF ERR = 74 THEN
PRINT ""
END IF
IF ERR = 61 THEN
PRINT "Disk full !!!"
ELSE
PRINT "Error !!!"
END IF
RESUME 1
HELP:
WIDTH 80, 25
SCREEN 0
COLOR 6, 9: CLS
PRINT "   --------------------  AYUDA ESPA¥OL DE DRAW v 1.0 --------------------- "
COLOR 2
PRINT
PRINT
PRINT " Comandos de DRAW:"
PRINT
COLOR 11
PRINT "ABOV: (ARRIBA)"
PRINT "     Utilice este comando para hacer una linea vertical recta hacia arriba."
PRINT
PRINT "CIRC: (CIRCULO)"
PRINT "     Dibuja circulos en la pantalla."
PRINT
PRINT "CLSC: (Borrar Pantalla)"
PRINT "     Borra la pantalla gr fica dejando el cursor en la misma posici¢n."
PRINT
PRINT "COLR: (COLOR)"
PRINT "     Cambia el color de las lineas."
PRINT
PRINT "DOWN: (ABAJO)"
PRINT "     Dibuja una linea vertical hacia abajo."
PRINT
GOSUB BORRAR
LOCATE 4, 1
PRINT "DRAW: (DIBUJAR)"
PRINT "     Coloca el sistema manual de dibujo."
PRINT
PRINT "EXIT: (SALIR)"
PRINT "     Avandona DRAW."
PRINT
PRINT "HOME: (HOGAR)"
PRINT "     Coloca el cursor en la posici¢n inicial."
PRINT
PRINT "LEFT: (IZQUIERDA)"
PRINT "     Dibuja una linea horizontal hacia la izquierda"
PRINT
PRINT "LINE: (LINEA)"
PRINT "      Dibuja una linea desde la posici¢n actual del cursor a un punto."
PRINT
PRINT "LSCL: (LISTA DE COLORES)"
PRINT "       Muestra la lista de colores en la pantalla."
GOSUB BORRAR
LOCATE 4, 1
PRINT "MOVA: (MOVER ARRIBA)"
PRINT "     Mueve el cursor hacia arriba."
PRINT
PRINT "MOVD: (MOVER ABAJO)"
PRINT "     Mueve el cursor hacia abajo."
PRINT
PRINT "MOVE: (MOVER)"
PRINT "     Coloca el cursor en la cordenada deseada."
PRINT
PRINT "MOVL: (MOVER IZQUIERDA)"
PRINT "     Mueve el cursor a la izquierda."
PRINT
PRINT "MOVR: (MOVER DERECHA)"
PRINT "     Mueve el cursor a la derecha."
PRINT
GOSUB BORRAR
LOCATE 4, 1
PRINT "NEWD: (NUEVO GRAFICA)"
PRINT "     Utilice este comando para crear un dibujo nuevo."
PRINT
PRINT "PANT: (COLOREAR)"
PRINT "     Permite colorear un area cerrada del dibujo."
GOSUB BORRAR
GOTO INI
BORRAR:
PRINT
PRINT
PRINT "  (Presione una tecla y contin£e)"
A$ = INPUT$(1)
IF A$ = CHR$(27) THEN GOTO INI
FOR A = 1 TO 80
A$ = INKEY$
FOR B = 2 TO 23
A$ = INKEY$
LOCATE B, A: PRINT " "
NEXT B
A$ = INKEY$
NEXT A
RETURN
NEWD:
X = 159: Y = 78
CLS 1
GOSUB BDC
GOSUB PEC
GOTO 1
PANT:
INPUT " * "; COCO
GOSUB BDC
PAINT (X, Y), COLSC, COCO
GOSUB PEC
GOTO 1
CREDIT:
COLOR 11
PRINT "Author: Jairo Alejandro Duarte A."
COLOR 3
PRINT "Collaboration: Juan Carlos Duarte A."
COLOR 6
PRINT "D.P.A. Software. Draw 1.0"
COLOR 7
RETURN
ERRORSR:
IF ERR = 5 THEN
SCR = SCR - 1
END IF
RESUME 1000
PANTL:
INPUT #1, COCO
GOSUB BDC
PAINT (X, Y), COLSC, COCO
GOSUB PEC

CONF:
CLOSE
FOR A = 2 TO 10
OPEN "C:DRAW.DAT" FOR APPEND AS #1
PRINT "F"; A; ": ";
INPUT A$
IF A$ = "*" THEN GOTO 1
KEY A, A$
PRINT #1, A$
CLOSE
NEXT A
GOTO 1

DAW:
A:
PRINT "X="; X; "Y="; Y
A$ = INPUT$(1)
IF A$ = "8" THEN GOTO ARRIBA
IF A$ = "2" THEN GOTO ABAJO
IF A$ = "4" THEN GOTO IZ
IF A$ = "6" THEN GOTO DE
IF A$ = "7" THEN GOTO IA
IF A$ = "9" THEN GOTO DA
IF A$ = "1" THEN GOTO IB
IF A$ = "3" THEN GOTO DB
IF A$ = "5" THEN GOTO CEN
IF A$ = "S" OR A$ = "s" THEN GOTO GRA
IF A$ = CHR$(13) THEN GOTO PA
IF A$ = " " THEN GOTO PINTAR
IF A$ = "c" OR A$ = "C" THEN GOTO COLORES
IF A$ = "P" OR A$ = "p" THEN GOTO PAN
IF A$ = CHR$(27) THEN GOTO 1
GOTO A
ARRIBA:
GOSUB BDC
Y = Y - 1
IF Y < 1 THEN Y = 1
GOSUB PEC
GOTO A

ABAJO:
GOSUB BDC
Y = Y + 1
IF Y > 154 THEN Y = 154
GOSUB PEC
GOTO A

IZ:
GOSUB BDC
X = X - 1
IF X < 1 THEN X = 1
GOSUB PEC
GOTO A

DE:
GOSUB BDC
X = X + 1
IF X > 317 THEN X = 317
GOSUB PEC
GOTO A

PINTAR:
PSET (X, Y), COLSC
X = X + 1
IF X > 317 THEN X = 317
GOSUB PEC
GOTO A
COLORES:
INPUT "Color"; COLSC
GOTO A
IA:
GOSUB BDC
X = X - 1: Y = Y - 1
IF Y < 1 THEN Y = 1
IF X < 1 THEN X = 1
GOSUB PEC
GOTO A

DA:
GOSUB BDC
X = X + 1: Y = Y - 1
IF Y < 1 THEN Y = 1
IF X > 317 THEN X = 317
GOSUB PEC
GOTO A

IB:
GOSUB BDC
X = X - 1: Y = Y + 1
IF Y > 154 THEN Y = 154
IF X < 1 THEN X = 1
GOSUB PEC
GOTO A

DB:
GOSUB BDC
X = X + 1: Y = Y + 1
IF Y > 154 THEN Y = 154
IF X > 317 THEN X = 317
GOSUB PEC
GOTO A

CEN:
GOSUB BDC
X = 159: Y = 78
GOSUB PEC

PA:
GOSUB BDC
PSET (X, Y), 0
GOSUB PEC
GOTO A

PAN:
INPUT "*", CONTORNO
IF CONTORNO = 0 THEN
PAINT (X, Y), COLSC
GOSUB BDC
ELSE
PAINT (X, Y), COLSC, CONTORNO
GOSUB BDC
GOSUB PEC
END IF
GOTO A
GRA:
INPUT "BASIC name:", BNAME$
IF BNAME$ = "" THEN GOTO A
OPEN BNAME$ FOR APPEND AS #1
KILL BNAME$
INPUT "Draw name:", DNAME$
IF DNAME$ = "" THEN GOTO A
OPEN DNAME$ FOR APPEND AS #1
KILL DNAME$
GOSUB BDC
FOR X = 1 TO 317
FOR Y = 1 TO 154
A$ = INKEY$
IF A$ = CHR$(27) THEN GOSUB PEC: GOTO A
GOSUB PEC
GOSUB BDC
C = POINT(X, Y)
PRINT "Please wait..."
IF C <> 0 THEN GOSUB GRABA
NEXT Y
NEXT X
GOTO A
GRABA:
IF BNAME$ = "" THEN GOTO 17
OPEN BNAME$ FOR APPEND AS #1
PRINT #1, "PSET("; X; ","; Y; "),"; C
CLOSE
17 IF BNAME$ = "" THEN GOTO 18
OPEN DNAME$ FOR APPEND AS #1
PRINT #1, X, Y; C
CLOSE
18 RETURN
LOAD:
INPUT "Name:", NAME$
OPEN NAME$ FOR INPUT AS #1
GOSUB BDC
DO
INPUT #1, A, B, C
IF C = 0 THEN GOTO 16
PSET (A, B), C
16 LOOP

