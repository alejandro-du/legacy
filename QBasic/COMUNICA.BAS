INICIO:
ON ERROR GOTO ERRORES
EXTENSION$ = ".COD"
CLOSE
COLOR 15, 8: CLS
LOCATE 2, 10: PRINT "******* COMUNICACIONES *******"
LOCATE 3, 10: PRINT "------------------------------"
COLOR 7
LOCATE 5, 1
90 PRINT
PRINT "¨ Cu l es tu codigo de entrada ?"
INPUT "", CODEN$
B = LEN(CODEN$)
IF B > 8 OR B < 1 THEN BEEP: GOTO 90
FOR A = 1 TO B
A$ = MID$(CODEN$, A, 1)
IF A$ = "." THEN BEEP: GOTO 90
NEXT A
CODENT$ = CODEN$ + EXTENSION$
OPEN CODENT$ FOR INPUT AS #1: CLOSE
GOTO CONTINUA
100 PRINT
PRINT "El codigo no se encontr¢."
110 PRINT "¨ Eres nuevo aqu¡ ?"
INPUT A$
B$ = LEFT$(A$, 1)
IF B$ = "S" OR B$ = "s" THEN GOTO CREARCOD
IF B$ = "N" OR B$ = "n" THEN GOTO 90 ELSE BEEP: GOTO 110
CREARCOD:
OPEN CODENT$ FOR APPEND AS #1: CLOSE
CONTINUA:
CLS
COLOR 15
LOCATE 2, 10: PRINT "******* COMUNICACIONES *******"
LOCATE 3, 10: PRINT "------------------------------"
COLOR 7
LOCATE 6, 1
PRINT "Listo..."
INPUT ACCION$
IF ACCION$ = "enviar" OR ACCION$ = "ENVIAR" THEN GOTO ENVIOMENS
IF ACCION$ = "reset" OR ACCION$ = "RESET" THEN GOTO INICIO
IF ACCION$ = "recibir" OR ACCION$ = "RECIBIR" THEN GOTO RECMENS
IF ACCION$ = "SALIR" OR ACCION$ = "salir" THEN GOTO SALIDA
IF ACCION$ = "codigos" OR ACCION$ = "CODIGOS" THEN GOTO COD:
IF ACCION$ = "BORRAR CODIGO" OR ACCION$ = "borrar codigo" THEN GOTO BCOD
RECMENS:
PRINT " - - - - - - - - - - - "
OPEN CODENT$ FOR INPUT AS #1
FOR A = 1 TO 4
LINE INPUT #1, DATA2$(A)
NEXT A
CLOSE
FOR A = 1 TO 4
PRINT DATA2$(A)
NEXT A
PRINT
PRINT
PRINT "Presione una tecla y contin£e..."
A$ = INPUT$(1)
GOTO CONTINUA
ENVIOMENS:
PRINT " - - - - - - - - - - - "
PRINT "¨ Nombre del mensaje ?"
INPUT "", DATA$(1)
PRINT " - - - - - - - - - - - "
PRINT "Dirigido a:"
INPUT "", DATA$(2)
PRINT " - - - - - - - - - - - "
PRINT "Otos datos del receptor:"
INPUT "", DATA$(3)
PRINT " - - - - - - - - - - - "
PRINT "Contenido del mensaje:"
INPUT "", DATA$(4)
120 PRINT " - - - - - - - - - - - "
PRINT "¨ Enviar ?"
INPUT "", A$
B$ = LEFT$(A$, 1)
IF A$ = "*" THEN GOTO CONTINUA
IF B$ = "S" OR B$ = "s" THEN GOTO ENVIOK
IF B$ = "N" OR B$ = "n" THEN GOTO CONTINUA ELSE BEEP: GOTO 120
ENVIOK:
PRINT " - - - - - - - - - - - "
PRINT "Enviar en c¢digo:"
INPUT ARCEN$
IF ARCEN$ = "*" THEN GOTO CONTINUA
ON ERROR GOTO ERROR2
B = LEN(ARCEN$)
IF B > 8 OR B < 1 THEN BEEP: GOTO ENVIOK
FOR A = 1 TO B
A$ = MID$(ARCEN$, A, 1)
IF A$ = "." THEN BEEP: GOTO ENVIOK
NEXT A
ARCENV$ = ARCEN$ + EXTENSION$
KILL ARCENV$
FOR A = 1 TO 4
OPEN ARCENV$ FOR APPEND AS #A
PRINT #A, DATA$(A)
CLOSE
NEXT A
GOTO CONTINUA



END
ERRORES:
IF ERR = 53 THEN GOTO ERROR52 ELSE END
ERROR52:
BEEP
RESUME 100
ERROR2:
IF ERR = 53 THEN GOTO ERROR252 ELSE END
ERROR252:
BEEP
PRINT
PRINT "C¢digo no existe."
RESUME ENVIOK
SALIDA:
COLOR 7, 8: CLS : END
COD:
SHELL "DIR *.COD /W /P"
END

BCOD:
COLOR 15
PRINT
PRINT " - - - - - - - - - - -"
SHELL "DIR *.COD /W /P"
PRINT
130 PRINT "BORRAR CODIGO:"
INPUT "", CODBO$
BEEP
PRINT
PRINT "ESTA SEGURO QUE DESEA BORRAR ESTE CODIGO ???"
INPUT "", SION$
SIONO$ = LEFT$(SION$, 1)
IF SIONO$ = "S" OR SIONO$ = "s" THEN GOTO SBCOD ELSE GOTO CONTINUA
SBCOD:
ON ERROR GOTO ERROR3
PRINT
PRINT "ELIMINANDO ....."
KILL CODBO$
GOTO CONTINUA
ERROR3:
IF ERR = 53 THEN GOTO 1 ELSE END
1 :
PRINT
PRINT "El codigo es incorrecto."
PRINT
RESUME 130

