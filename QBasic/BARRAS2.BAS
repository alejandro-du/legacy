6 CLEAR
DIM NUMBAR(9), VALOR(10), ETIQUETA$(9)
ON ERROR GOTO ERRORES
0 SCREEN 0: WIDTH 80: CLS
FOR A = 2 TO 10: ON KEY(A) GOSUB FIN: KEY(A) ON: NEXT A
LOCATE 1, 20: PRINT CHR$(201); STRING$(38, CHR$(205)); CHR$(187)
LOCATE 2, 20: PRINT CHR$(186); SPC(38); CHR$(186)
LOCATE 3, 20: PRINT CHR$(186); SPC(4); "GENERADOR DE GRAFICO DE BARRAS"; SPC(4); CHR$(186)
LOCATE 4, 20: PRINT CHR$(186); SPC(38); CHR$(186)
LOCATE 5, 20: PRINT CHR$(200); STRING$(38, CHR$(205)); CHR$(188)
3 LOCATE 8, 5: INPUT "T¡tulo del gr fico: ", TITULO$
IF LEN(TITULO$) > 77 THEN
   BEEP
   LOCATE 8: PRINT SPACE$(80)
   FOR I = 9 TO 11: LOCATE I: PRINT SPACE$(80): NEXT I
   GOTO 3
END IF
1 LOCATE 10, 5: INPUT "N£mero de barras: (1-8) ", N$: NUMBAR = VAL(N$)
IF NUMBAR < 1 OR NUMBAR > 8 THEN BEEP: LOCATE 10: PRINT SPACE$(80): FOR L = 1 TO 3: LOCATE L + 10: PRINT SPACE$(80): NEXT L: GOTO 1
FOR I = 1 TO NUMBAR
2  LOCATE I + 12, 1: PRINT I; "¦"
   LOCATE I + 12, 6: INPUT "Valor: "; VALOR$
   VALOR(I) = INT(VAL(VALOR$))
   IF VALOR(I) < 1 OR VALOR(I) > 10 THEN BEEP: LOCATE I + 12: PRINT SPACE$(80): GOTO 2
   LOCATE I + 12, 42: INPUT "Etiqueta: "; VALOR$
   ETIQUETA$(I) = LEFT$(VALOR$, 9)
NEXT I
'
'********** IMPRESION DEL GRAFICO CON SUS RESPECTIVAS ETIQUETAS **********
'
CLS
BARRA$ = "": FOR A = 1 TO 8: BARRA$ = BARRA$ + CHR$(178): NEXT A
IF NUMBAR > 6 THEN LOCATE 3, 40 - (LEN(TITULO$) / 2 + .5): PRINT TITULO$ ELSE LOCATE 1, 1: PRINT TITULO$
FIL = 17: COL = 1
FOR Q = 1 TO NUMBAR
   A$ = INKEY$
   FOR O = 1 TO VALOR(Q)
      A$ = INKEY$
      LOCATE FIL, COL: PRINT BARRA$
      FIL = FIL - 1
   NEXT O
   LOCATE 18, COL: PRINT ETIQUETA$(Q)
   COL = COL + 10
   FIL = 17
   A$ = INKEY$
NEXT Q
DO
LOCATE 22, 1: PRINT "(Presione una tecla para continuar, F1 para imprimir)"
ON KEY(1) GOSUB 5: KEY(1) ON
INPUT "", A$
IF A$ <> "" THEN GOTO 0
LOOP
GOTO 0
5
LOCATE 22: PRINT SPACE$(80)
LOCATE 23: PRINT SPACE$(80)
INPUT "", A$
RETURN
FIN:
CLS : END
ERRORES:
IF ERR = 6 THEN
PRINT "­­­­­­­­­ DESBORDAMIENTO !!!!!!!!!!"
A$ = INPUT$(1)
END IF
RESUME 6

